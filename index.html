<html lang="ru" style="--tg-viewport-height: 100vh; --tg-viewport-stable-height: 100vh;"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Сайт с шапкой</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: Arial, sans-serif;
        background-color: #000000;
        padding: 0;
        margin: 0;
      }

      header {
        width: 100%;
        height: auto;
      }

      header img {
        width: 100%;  /* Сделаем так, чтобы изображение занимало всю ширину экрана */
        height: auto;  /* Высота будет автоматически подстраиваться */
      }

      main {
        width: 100%;
        display: flex;
        justify-content: center;
        padding: 20px;
        box-sizing: border-box;
      }

      .content {
        width: 100%;
        max-width: 1920px; /* Максимальная ширина контента */
        padding: 20px;
        background-color: rgb(0, 0, 0);
        border-radius: 8px;
      }

      h2 {
        text-align: center;
        color: #333;
      }

      input[type="text"] {
    width: 100%;
    padding: 10px;
    font-size: 16px;
    margin: 10px 0;
    border: 1px solid #575757;  /* Серые границы */
    border-radius: 5px;
    background-color: #333333;  /* Черный фон */
    color: white;  /* Белый цвет текста */
}


      button {
        width: 100%;
        padding: 10px;
        font-size: 16px;
        background-color: #4CAF50;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
      }

      button:hover {
        background-color: #45a049;
      }

      .status {
        margin-top: 10px;
        padding: 10px;
        background-color: #e1e1e1;
        border-radius: 5px;
        display: none;
        text-align: center;
      }

      .status.success {
        background-color: #4CAF50;
        color: white;
      }

      .status.error {
        background-color: #FF6347;
        color: white;
      }
    </style>
</head>
<body>
    <header>
        <img src="https://psv4.userapi.com/s/v1/d/_AMJREH6noNgkCt1h2Zmfb74nA6i086uWTBSc41V4atqXD8wchnyuBjMQZXdJb-mM6O4bc4dT8ZJaAVs-NecZKnl5MQlQnrwtNhAe0yAaV3hyZRSDGKjVA/7.png" alt="Шапка сайта">
    </header>
    <main>
        <div class="content">
            <form id="message-form">
                <input type="text" id="message" placeholder="Введите ваше сообщение..." required="">
                <button type="submit">Отправить</button>
            </form>
            <div id="status" class="status error" style="display: block;">Ошибка: не удалось получить данные пользователя.</div>
        </div>
    </main>

    <script>
      const form = document.getElementById('message-form');
      const statusDiv = document.getElementById('status');

      // Получаем данные пользователя через initDataUnsafe
      const user = Telegram.WebApp.initDataUnsafe ? Telegram.WebApp.initDataUnsafe.user : null;

      if (!user) {
        statusDiv.textContent = 'Ошибка: не удалось получить данные пользователя.';
        statusDiv.className = 'status error';
        statusDiv.style.display = 'block';
        console.log("Ошибка инициализации WebApp: нет данных пользователя.");
      } else {
        console.log("Данные пользователя:", user);

        form.onsubmit = (e) => {
          e.preventDefault();
          const message = document.getElementById('message').value;

          // Если сообщение не пустое, отправляем в бот
          if (message) {
            try {
              // Ваш токен бота
              const botToken = '7488318384:AAH2H0idqXmKoLzE7wJPRPd_Vp5S-5TkTDo';
              // Чат ID (можно использовать ID админа или группы)
              const chatId = '511301057';

              // Формируем текст для отправки в бота
              const text = `Ник: ${user.username}\nСообщение: ${message}`;

              console.log("Тело запроса:", {
                chat_id: chatId,
                text: text,
              });

              // Отправляем запрос к API Telegram
              fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                  chat_id: chatId,
                  text: text,
                }),
              }).then(response => {
                if (response.ok) {
                  statusDiv.textContent = 'Сообщение успешно отправлено!';
                  statusDiv.className = 'status success';
                } else {
                  response.text().then(text => {
                    console.log('Ошибка ответа:', text);
                  });
                  statusDiv.textContent = 'Ошибка при отправке сообщения.';
                  statusDiv.className = 'status error';
                }
                statusDiv.style.display = 'block';
              }).catch((error) => {
                console.log('Ошибка при отправке запроса:', error);
                statusDiv.textContent = 'Ошибка при отправке сообщения.';
                statusDiv.className = 'status error';
                statusDiv.style.display = 'block';
              });
            } catch (error) {
              console.log('Ошибка при обработке сообщения:', error);
              statusDiv.textContent = 'Ошибка при обработке сообщения.';
              statusDiv.className = 'status error';
              statusDiv.style.display = 'block';
            }
          } else {
            statusDiv.textContent = 'Ошибка: сообщение не может быть пустым.';
            statusDiv.className = 'status error';
            statusDiv.style.display = 'block';
          }
        };
      }
    </script>


</body></html>
